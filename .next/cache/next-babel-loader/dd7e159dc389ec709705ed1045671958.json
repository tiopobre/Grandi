{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Daniel Serrano\\\\Documents\\\\Grandi\\\\pages\\\\nuevo-cultivo.jsx\";\n\nvar __jsx = React.createElement;\nimport React, { useState, useContext } from 'react';\nimport Layaout from '../components/Layaout/layaout';\nimport Router from 'next/router';\nimport firebase from '../firebase'; // para añadir imagenes\n\nvar uniqid = require('uniqid'); //validaciones\n\n\nimport useValidacion from '../hooks/useValidacion';\nimport validarNuevoCultivo from '../validacion/validarNuevoCultivo';\nimport { FirebaseContext } from '../firebase'; // context\n// State Inicial\n\nvar STATE_INICIAL = {\n  planta: '',\n  alias: '',\n  fechaIni: '',\n  descripcion: '',\n  img: '',\n  urlImg: 'll',\n  votos: 0\n};\n\nvar nuevoCultivo = function nuevoCultivo() {\n  var _useValidacion = useValidacion(STATE_INICIAL, validarNuevoCultivo, agregarCultivo),\n      valores = _useValidacion.valores,\n      errores = _useValidacion.errores,\n      handleChange = _useValidacion.handleChange,\n      handleSubmit = _useValidacion.handleSubmit;\n\n  var planta = valores.planta,\n      alias = valores.alias,\n      fechaIni = valores.fechaIni,\n      img = valores.img,\n      urlImg = valores.urlImg,\n      descripcion = valores.descripcion; // State Imagenes\n\n  var _useState = useState(null),\n      imagen = _useState[0],\n      setImagen = _useState[1];\n\n  var _useState2 = useState(''),\n      urlImagen = _useState2[0],\n      setUrlImagen = _useState2[1]; // context con las crud de firebase\n\n\n  var _useContext = useContext(FirebaseContext),\n      usuario = _useContext.usuario,\n      firebase = _useContext.firebase; // Imagenes\n\n\n  function cambioImagen(e) {\n    if (e.target.files[0]) {\n      setImagen(e.target.files[0]);\n    } // console.log(uniqid.process());\n    //crear id imagen\n\n\n    setUrlImagen(uniqid('cultivo'));\n    console.log('id', urlImagen);\n  }\n\n  function crrear_cultivo() {\n    var cultivo = {\n      planta: planta,\n      alias: alias,\n      fechaIni: fechaIni,\n      descripcion: descripcion,\n      urlImg: urlImagen,\n      comentarios: [],\n      votos: 0,\n      creador: {\n        id: usuario.uid,\n        nombre: usuario.displayName\n      }\n    };\n    firebase.db.collection('cultivos').add(cultivo);\n  }\n\n  var handleURL = function handleURL() {\n    console.log(\"entra handle url\");\n    firebase.storage.ref(\"test_imagenes\").child(imagen.name).getDownloadURL().then(function (url) {\n      console.log(\"url\", url);\n      setUrlImagen(url);\n    });\n  }; // agregar a firestore y storage\n\n\n  function agregarCultivo() {\n    var cultivo;\n    return _regeneratorRuntime.async(function agregarCultivo$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log('agregando cultivo...');\n\n            if (usuario) {\n              _context.next = 3;\n              break;\n            }\n\n            return _context.abrupt(\"return\", Router.push('/login'));\n\n          case 3:\n            firebase.storage.ref('test_imagenes').child(imagen.name).put(imagen);\n            handleURL();\n            console.log(\"Usuario\", usuario.uid);\n            console.log(urlImagen); // Crear cultivo\n\n            cultivo = {\n              planta: planta,\n              alias: alias,\n              fechaIni: fechaIni,\n              descripcion: descripcion,\n              urlImg: urlImagen,\n              comentarios: [],\n              votos: 0,\n              creador: {\n                id: usuario.uid,\n                nombre: usuario.displayName\n              }\n            }; //insertar en la base de datos\n            //firebase.storage.ref('test_imagenes').child(urlImagen).put(imagen);\n            //firebase.db.collection('cultivos').add(cultivo);\n            //return Router.push('/perfil');\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return __jsx(React.Fragment, null, __jsx(Layaout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"contenedor\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }, __jsx(\"h2\", {\n    className: \"d-flex justify-content-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }, \"Nuevo Cultivo\"), __jsx(\"div\", {\n    className: \"d-flex flex-row bd-highligh justify-content-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 17\n    }\n  }, __jsx(\"form\", {\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 23\n    }\n  }, __jsx(\"label\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 29\n    }\n  }, \"Planta\"), __jsx(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"planta\",\n    placeholder: \"Tipo de planta\",\n    value: planta,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 29\n    }\n  }), errores.planta && __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 48\n    }\n  }, errores.planta)), __jsx(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 25\n    }\n  }, __jsx(\"label\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 29\n    }\n  }, \"Alias\"), __jsx(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"alias\",\n    placeholder: \"alias de tu planta\",\n    value: alias,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 29\n    }\n  }), __jsx(\"small\", {\n    className: \"form-text text-muted\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }, \"Dale un alias a tu cultivo.\")), __jsx(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 25\n    }\n  }, __jsx(\"label\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 29\n    }\n  }, \"Sube una Imagen\"), __jsx(\"input\", {\n    type: \"file\",\n    onChange: cambioImagen,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 29\n    }\n  })), __jsx(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 25\n    }\n  }, __jsx(\"label\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 29\n    }\n  }, \"Fecha Inicial\"), __jsx(\"input\", {\n    type: \"date\",\n    className: \"form-control\",\n    name: \"fechaIni\",\n    value: fechaIni,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 29\n    }\n  }), errores.fechaIni && __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 50\n    }\n  }, errores.fechaIni)), __jsx(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 25\n    }\n  }, __jsx(\"label\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 29\n    }\n  }, \"Descripcion Cultivo\"), __jsx(\"input\", {\n    className: \"form-control\",\n    name: \"descripcion\",\n    value: descripcion,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 29\n    }\n  })), __jsx(\"button\", {\n    type: \"submit\",\n    value: \"crear cultivo\",\n    className: \"btn btn-lg btn-primary btn-block btn-signin\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 25\n    }\n  }, \"Agregar Cultivo\"))))));\n};\n\nexport default nuevoCultivo;","map":{"version":3,"sources":["C:/Users/Daniel Serrano/Documents/Grandi/pages/nuevo-cultivo.jsx"],"names":["React","useState","useContext","Layaout","Router","firebase","uniqid","require","useValidacion","validarNuevoCultivo","FirebaseContext","STATE_INICIAL","planta","alias","fechaIni","descripcion","img","urlImg","votos","nuevoCultivo","agregarCultivo","valores","errores","handleChange","handleSubmit","imagen","setImagen","urlImagen","setUrlImagen","usuario","cambioImagen","e","target","files","console","log","crrear_cultivo","cultivo","comentarios","creador","id","uid","nombre","displayName","db","collection","add","handleURL","storage","ref","child","name","getDownloadURL","then","url","push","put"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport Layaout from '../components/Layaout/layaout'\r\nimport Router from 'next/router'\r\nimport firebase from '../firebase';\r\n// para añadir imagenes\r\nvar uniqid = require('uniqid');\r\n//validaciones\r\nimport useValidacion from '../hooks/useValidacion'\r\nimport validarNuevoCultivo from '../validacion/validarNuevoCultivo'\r\nimport {FirebaseContext} from '../firebase' // context\r\n// State Inicial\r\nconst STATE_INICIAL = {\r\n    planta: '',\r\n    alias: '',\r\n    fechaIni: '',\r\n    descripcion: '',\r\n    img: '',\r\n    urlImg:'ll',\r\n    votos : 0,\r\n}\r\n\r\nconst nuevoCultivo = () => {\r\n    \r\n    const {valores, errores, handleChange, handleSubmit} =  useValidacion(STATE_INICIAL, validarNuevoCultivo, agregarCultivo);\r\n    const {planta, alias, fechaIni,img ,urlImg , descripcion } = valores;\r\n    // State Imagenes\r\n    const [imagen, setImagen] = useState(null);\r\n    const [urlImagen, setUrlImagen] = useState('');\r\n    // context con las crud de firebase\r\n    const {usuario, firebase} = useContext(FirebaseContext);\r\n    \r\n    // Imagenes\r\n    \r\n    function cambioImagen (e){\r\n        if(e.target.files[0]){\r\n            setImagen(e.target.files[0]);\r\n        }\r\n       // console.log(uniqid.process());\r\n       //crear id imagen\r\n        setUrlImagen(uniqid('cultivo'));\r\n        \r\n        console.log( 'id', urlImagen);\r\n    }\r\n\r\n    function crrear_cultivo(){\r\n        const cultivo = {\r\n            planta: planta,\r\n            alias: alias,\r\n            fechaIni: fechaIni,\r\n            descripcion: descripcion,\r\n            urlImg: urlImagen,\r\n            comentarios: [],\r\n            votos: 0,\r\n            creador: {\r\n                id : usuario.uid,\r\n                nombre: usuario.displayName\r\n            }\r\n        }\r\n        firebase.db.collection('cultivos').add(cultivo);\r\n    }\r\n    const handleURL = () =>{\r\n        console.log(\"entra handle url\");\r\n        firebase.storage\r\n        .ref(\"test_imagenes\")\r\n        .child(imagen.name)\r\n        .getDownloadURL()\r\n        .then( url =>{\r\n             console.log(\"url\", url);\r\n             setUrlImagen(url);\r\n        }\r\n        )\r\n    }\r\n\r\n    // agregar a firestore y storage\r\n    async function agregarCultivo(){\r\n            console.log('agregando cultivo...')\r\n            if(!usuario){\r\n                return Router.push('/login');\r\n            }\r\n\r\n            firebase.storage.ref('test_imagenes').child(imagen.name).put(imagen);\r\n            handleURL();\r\n            console.log(\"Usuario\", usuario.uid);\r\n            console.log(urlImagen);\r\n            // Crear cultivo\r\n            const cultivo = {\r\n                planta: planta,\r\n                alias: alias,\r\n                fechaIni: fechaIni,\r\n                descripcion: descripcion,\r\n                urlImg: urlImagen,\r\n                comentarios: [],\r\n                votos: 0,\r\n                creador: {\r\n                    id : usuario.uid,\r\n                    nombre: usuario.displayName\r\n                }\r\n            }\r\n            \r\n            //insertar en la base de datos\r\n            //firebase.storage.ref('test_imagenes').child(urlImagen).put(imagen);\r\n            //firebase.db.collection('cultivos').add(cultivo);\r\n            //return Router.push('/perfil');\r\n        }\r\n\r\n    return ( \r\n        <>\r\n            <Layaout>\r\n                <div className=\"contenedor\">\r\n                <h2  className=\"d-flex justify-content-center\">Nuevo Cultivo</h2>\r\n                <div className=\"d-flex flex-row bd-highligh justify-content-center\">\r\n                    <form \r\n                        onSubmit = {handleSubmit}\r\n                    >\r\n                      <div className=\"form-group\">\r\n                            <label >Planta</label>\r\n                            <input \r\n                                type=\"text\" \r\n                                className=\"form-control\" \r\n                                name = \"planta\"\r\n                                placeholder=\"Tipo de planta\"\r\n                                value = {planta}\r\n                                onChange ={handleChange}\r\n                            />\r\n                            {errores.planta && <p>{errores.planta}</p>}\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label >Alias</label>\r\n                            <input \r\n                                type=\"text\" \r\n                                className=\"form-control\" \r\n                                name = \"alias\"\r\n                                placeholder=\"alias de tu planta\"  \r\n                                value = {alias}\r\n                                onChange ={handleChange}\r\n                            />\r\n                            <small \r\n                             \r\n                            className=\"form-text text-muted\"\r\n                            >Dale un alias a tu cultivo.</small>\r\n                        </div>\r\n\r\n                        <div className=\"form-group\">\r\n                            <label >Sube una Imagen</label>\r\n                            <input \r\n                                type = \"file\"\r\n                                \r\n                                onChange ={cambioImagen}\r\n                            />  \r\n                        </div>\r\n\r\n                        <div className=\"form-group\">\r\n                            <label >Fecha Inicial</label>\r\n                            <input \r\n                                type=\"date\" \r\n                                className=\"form-control\" \r\n                                name = \"fechaIni\"\r\n                                value = {fechaIni}\r\n                                onChange ={handleChange}\r\n                            />  \r\n                            {errores.fechaIni && <p>{errores.fechaIni}</p>}\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label >Descripcion Cultivo</label>\r\n                            <input \r\n                                className=\"form-control\" \r\n                                name = \"descripcion\"\r\n                                value = {descripcion}\r\n                                onChange ={handleChange}\r\n                            />  \r\n                        </div>\r\n                        <button \r\n                            type=\"submit\" \r\n                            value= \"crear cultivo\"\r\n                            className=\"btn btn-lg btn-primary btn-block btn-signin\"\r\n                        >Agregar Cultivo</button>  \r\n                    </form> \r\n                </div>\r\n                </div>\r\n            </Layaout> \r\n        </>\r\n     );\r\n}\r\n \r\nexport default nuevoCultivo;"]},"metadata":{},"sourceType":"module"}